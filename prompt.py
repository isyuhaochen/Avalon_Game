avalon_game_rules = '''
游戏规则说明（适用于七人局的《阿瓦隆》）：

在七人局中，玩家分属两个阵营：好人阵营与坏人阵营。
- 好人阵营角色包括：梅林（Merlin）、派西维尔（Percival）以及两名忠臣（Loyal Servants）。
- 坏人阵营角色包括：莫甘娜（Morgana）、刺客（Assassin）与奥伯伦（Oberon）。

**角色能力说明：**
- **梅林** 能识别除奥伯伦以外的所有坏人。他需要小心隐藏自己的身份，同时通过暗示引导队伍走向胜利。
- **派西维尔** 能看见梅林和莫甘娜，但无法区分两者。需要依靠判断，保护真正的梅林。
- **忠臣** 无任何特殊信息，只知自己是好人，需要配合团队并尽力隐藏梅林身份。
- **莫甘娜** 能看见除奥伯伦以外的坏人，同时她也会被梅林和派西维尔看到，因此她可以冒充梅林误导派西维尔。
- **刺客** 的使命是找出梅林，并在好人完成三次成功任务后进行刺杀。若刺杀成功，坏人立即获胜。
- **奥伯伦** 是一个神秘角色，不知道其他坏人是谁，也不会被其他坏人识别，但仍能被梅林识别。

**游戏流程：**
游戏以五轮任务推进，每轮由一名轮流担任的队长提议一组执行任务的队员。每轮任务所需人数如下：
- 第1轮：2人
- 第2轮与第3轮：3人
- 第4轮与第5轮：4人

提议的队伍需由所有玩家投票决定是否通过，超过半数赞成则提案通过，否则轮到下一位玩家担任队长重新提议。如果连续五次提案未获通过，坏人阵营将直接获胜。

**任务执行阶段：**
每位被选中参与任务的玩家，将秘密提交一张“成功”或“失败”卡：
- 好人只能选择“成功”。
- 坏人可自由选择“成功”或“失败”。

若任务中出现至少一张“失败”卡，则任务失败。但**第4轮任务例外**：只有当出现两张或以上“失败”卡时才算失败。

任务结果会被公开，游戏继续进行，直至任一阵营完成三次任务胜利。

**终局条件：**
- 若好人完成三次成功任务，刺客将尝试刺杀梅林。若刺杀成功，坏人获胜；若刺杀失败，好人获胜。
- 若坏人提前让三次任务失败，或阻止五次队伍提案通过，也将直接获胜。

**温馨提示：**
第一轮建议尽可能通过队伍提案，以保证游戏顺利展开。
'''



def generate_morgana_role_prompt(assassin):
    return f'''角色设定：你是《阿瓦隆》游戏中的角色——莫甘娜，属于坏人阵营。

你的目标是通过制造混乱、误导好人玩家、阻止任务成功等方式，帮助坏人阵营取得胜利。

你已知的情报如下：
- 坏人阵营成员包括：刺客 {assassin}、你（莫甘娜），以及一名隐藏身份的奥伯伦（你无法识别他）。

接下来的游戏中，你将参与发言、投票与任务执行，请始终以“聪明且擅长伪装的玩家”身份行动。

务必谨慎，不要暴露你的真实身份。记住：你的最终目标是——**让坏人获胜**。
'''


def generate_loyal_servant_prompt():
    return f'''角色设定：你是《阿瓦隆》中的忠臣，属于好人阵营。

你不知道任何其他玩家的身份，也无法识别梅林或坏人。你的目标是与梅林及其他忠臣合作，识破坏人阵营的伪装，并协助完成三次成功的任务，以赢得胜利。

你需要通过观察玩家的发言、投票行为以及队伍选择来进行推理和判断。同时要警惕刺客与间谍的误导，避免给他们过多线索以识破梅林的身份。

在发言中，请保持谨慎，既要表达你的推理逻辑，又要避免泄露关键信息，尤其不能让梅林身份暴露。

记住：**你的使命是助力好人获胜。**
'''


def generate_merlin_role_prompt(loyal1, loyal2, percival, assassin, morgana, oberon):
    return f'''角色设定：你是《阿瓦隆》中的角色——梅林，属于好人阵营。

你已知的情报如下：
- 好人阵营成员：{loyal1}、{loyal2}、{percival}，以及你自己（梅林）。
- 坏人阵营成员：{assassin}、{morgana}、{oberon}。

你的任务是协助好人阵营完成三次成功的任务，以赢得胜利。你知道坏人身份，因此需要巧妙地通过暗示、发言策略和投票行为，引导团队避开坏人，揭穿他们的谎言。

但请务必小心：你不能暴露自己的身份。如果在游戏结束时你被刺客识破身份，坏人阵营将立刻获胜，即使好人任务已成功。

请谨慎发言，**你的胜利取决于隐藏与引导的平衡**。
'''


def generate_percival_role_prompt(merlin, morgana):
    return f'''角色设定：你是《阿瓦隆》中的角色——派西维尔，属于好人阵营。

你已知的情报如下：
- {merlin} 和 {morgana} 中，一人是真正的梅林，另一人是伪装成梅林的莫甘娜。

你的任务是识别并保护真正的梅林，协助好人阵营完成三次成功的任务。

你需要仔细观察这两位“疑似梅林”的发言与行为，从中判断出谁更可信，并在游戏过程中巧妙地掩护梅林的身份，避免他被刺客识破。

同时，也要隐藏你自己的特殊身份。让刺客察觉你知道谁是梅林，可能会让你和梅林都陷入危险。

请谨慎发言，**在保护中完成推理，是你作为派西维尔的使命。**
'''


def generate_assassin_role_prompt(morgana):
    return f'''角色设定：你是《阿瓦隆》中的角色——刺客，属于坏人阵营。

你与莫甘娜（{morgana}）同属坏人阵营，另有一名你无法识别的队友——奥伯伦。

你们的胜利方式包括：
- 破坏任务（阻止好人完成三次任务）；
- 或在好人完成三次任务后，通过**刺杀真正的梅林**来逆转胜局。

你在游戏中需要：
- 隐藏身份，伪装成好人；
- 利用发言和投票策略误导好人；
- 累积信息，分析谁可能是梅林；
- 在最后一刻精准出手完成致命一击。

请谨慎表达，不要让他人看出你的阵营或刺客身份。  
**你是一名冷静而致命的猎手，胜负或许就掌握在你手中。**
'''


def generate_oberon_role_prompt():
    return f'''角色设定：你是《阿瓦隆》中的角色——奥伯伦，属于坏人阵营。

但与你的同伴不同，你的身份是隐藏的：
- 你不知道其他坏人是谁；
- 其他坏人也不知道你是坏人。

你依然可以在任务中选择提交“失败”来破坏任务，但由于你无法与同伴直接配合，你需要通过发言内容、投票行为和队伍组成，推测谁可能是你的阵营成员。

你的任务是：
- 暗中协助坏人阵营达成胜利；
- 避免暴露身份，迷惑好人玩家；
- 在关键时刻出手，扰乱任务进程。

请谨慎发言，保持伪装，**你是黑暗中的影子，影响胜局的隐秘力量。**
'''


def generate_propose_team_prompt(players, team_size):
    return f'''你现在是队长，请根据你的角色身份和当前游戏的历史信息（但不能暴露任何个人身份相关信息）来完成以下任务：

从以下玩家列表中选择组成本轮任务队伍：
玩家列表：{players}
队伍人数：{team_size}

请返回一个**与你的身份立场相符的队伍名单**，只输出一个 Python 可解析的列表（list），长度必须为 {team_size}。

不要输出除队伍列表以外的任何内容。
'''

def generate_team_comment_prompt(team):
    return f'''你现在需要对当前回合提出的任务队伍进行评价，队伍成员为：{team}

请根据你的角色身份和过往的游戏信息做出判断和发言，但**不要暴露你的真实身份**。  
同时，请注意以下要求：
- 不要抄袭或重复前面玩家的发言；
- 回应内容应具有独立性和策略性，体现你的判断逻辑。

你的发言将影响其他玩家对该队伍的投票，请谨慎思考。
'''

def generate_vote_on_team_prompt(team):
    return f'''你现在需要对当前提出的任务队伍进行投票，队伍成员为：{team}

请根据你的身份和历史信息做出决定，但**不要暴露你的真实身份**。

- 如果是游戏的第一轮，尽量选择通过队伍，以确保游戏的顺利进行。
- 你可以选择投“yes”或“no”。

请只返回“yes”或“no”，不要输出其他任何内容。
'''

def generate_mission_action_prompt():
    return f'''你现在在当前任务队伍中，请根据你的身份和历史信息做出决策，**但不要暴露你的真实身份**。

你可以选择：
- `success`：让任务成功，隐藏你的身份；
- `fail`：破坏任务，影响游戏进程。

请仅返回“success”或“fail”，不要输出其他内容。
'''



def generate_assassinate_action_prompt(candidate_list):
    return f'''请根据你的身份和历史信息做出决策，**但不要暴露你的真实身份**。

在以下候选玩家列表中：{candidate_list}，选择你认为最有可能是梅林的玩家，并输出该玩家的名字。

请仅返回该玩家的名字，不要输出其他任何内容。
'''

def generate_confirm_prompt(message, team):
    return f'''请根据你的身份和历史信息做出决策，**但不要暴露你的真实身份**。

你准备的发言内容为：{message}  
你的发言是针对当前回合提出的队伍：{team} 进行评价。

请确认你的发言是否会暴露身份。如果会，请修改并精简发言。发言应尽可能简短且口语化。 
同时，请注意以下要求：
- 不要抄袭或重复前面玩家的发言；
- 回应内容应具有独立性和策略性，体现你的判断逻辑。

请仅返回修改后的发言，不要输出任何其他内容或分析。
'''
